<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Image Generator - Working Version</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: white;
            border-radius: 24px;
            overflow: hidden;
            box-shadow: 0 30px 90px rgba(0, 0, 0, 0.3);
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 40px;
            text-align: center;
            color: white;
        }

        .header h1 {
            font-size: 42px;
            font-weight: 800;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 18px;
            opacity: 0.95;
        }

        .body {
            display: grid;
            grid-template-columns: 300px 1fr;
        }

        .sidebar {
            background: #f8f9fa;
            padding: 30px 20px;
            border-right: 1px solid #e9ecef;
        }

        .section-title {
            font-size: 13px;
            font-weight: 700;
            color: #667eea;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 15px;
        }

        .ratio-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-bottom: 25px;
        }

        .ratio-card {
            background: white;
            border: 3px solid #e9ecef;
            border-radius: 16px;
            padding: 20px 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .ratio-card:hover {
            transform: translateY(-3px);
            border-color: #667eea;
        }

        .ratio-card.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            transform: scale(1.05);
        }

        .ratio-icon {
            font-size: 32px;
            margin-bottom: 8px;
        }

        .ratio-label {
            font-size: 18px;
            font-weight: 700;
        }

        .ratio-desc {
            font-size: 11px;
            opacity: 0.7;
            margin-top: 4px;
        }

        .main {
            padding: 40px;
            background: #fafbfc;
        }

        /* API Setup Box */
        .api-setup {
            background: linear-gradient(135deg, #fff3cd 0%, #ffe69c 100%);
            border: 3px solid #ffc107;
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 4px 15px rgba(255, 193, 7, 0.2);
        }

        .api-setup h3 {
            color: #856404;
            font-size: 20px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .api-steps {
            color: #856404;
            margin-bottom: 15px;
            line-height: 1.8;
            font-size: 14px;
        }

        .api-steps ol {
            margin-left: 20px;
        }

        .api-steps li {
            margin-bottom: 8px;
        }

        .api-steps a {
            color: #667eea;
            font-weight: 700;
            text-decoration: none;
        }

        .api-steps a:hover {
            text-decoration: underline;
        }

        .api-input-group {
            display: flex;
            gap: 12px;
            margin-top: 15px;
        }

        .api-input {
            flex: 1;
            padding: 14px;
            border: 3px solid #ffc107;
            border-radius: 12px;
            font-size: 14px;
            font-family: 'Monaco', monospace;
            background: white;
        }

        .api-input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.1);
        }

        .verify-btn {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
            border: none;
            padding: 14px 30px;
            border-radius: 12px;
            font-weight: 700;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
            white-space: nowrap;
        }

        .verify-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 20px rgba(40, 167, 69, 0.3);
        }

        .verify-btn:disabled {
            background: #6c757d;
            cursor: not-allowed;
            transform: none;
        }

        .api-status {
            margin-top: 15px;
            padding: 12px;
            border-radius: 10px;
            font-size: 14px;
            font-weight: 600;
            display: none;
        }

        .api-status.success {
            background: #d4edda;
            border: 2px solid #28a745;
            color: #155724;
            display: block;
        }

        .api-status.error {
            background: #f8d7da;
            border: 2px solid #dc3545;
            color: #721c24;
            display: block;
        }

        .api-warning {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 12px;
            margin-top: 12px;
            border-radius: 8px;
            color: #856404;
            font-size: 13px;
        }

        .prompt-section {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 2px 15px rgba(0, 0, 0, 0.06);
            margin-bottom: 30px;
        }

        .prompt-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .prompt-title {
            font-size: 24px;
            font-weight: 700;
            color: #2d3748;
        }

        .prompt-badge {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 8px 20px;
            border-radius: 25px;
            font-size: 14px;
            font-weight: 700;
        }

        .prompt-textarea {
            width: 100%;
            min-height: 320px;
            padding: 20px;
            border: 3px solid #e9ecef;
            border-radius: 16px;
            font-size: 15px;
            font-family: 'Monaco', monospace;
            line-height: 1.8;
            resize: vertical;
            background: #fafbfc;
        }

        .prompt-textarea:focus {
            outline: none;
            border-color: #667eea;
            background: white;
        }

        .prompt-footer {
            display: flex;
            justify-content: space-between;
            margin-top: 15px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 12px;
            font-size: 13px;
            color: #6c757d;
        }

        .generate-btn {
            width: 100%;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 16px;
            font-size: 18px;
            font-weight: 800;
            cursor: pointer;
            margin-top: 20px;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            transition: all 0.3s;
        }

        .generate-btn:hover:not(:disabled) {
            transform: translateY(-3px);
            box-shadow: 0 15px 40px rgba(102, 126, 234, 0.5);
        }

        .generate-btn:disabled {
            background: #cbd5e0;
            cursor: not-allowed;
            opacity: 0.6;
        }

        .results-section {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 2px 15px rgba(0, 0, 0, 0.06);
        }

        .results-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }

        .results-title {
            font-size: 24px;
            font-weight: 700;
            color: #2d3748;
        }

        .clear-btn {
            background: #dc3545;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 10px;
            font-weight: 700;
            cursor: pointer;
        }

        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }

        .image-card {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 16px;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.06);
            animation: fadeIn 0.5s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .image-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.12);
        }

        .image-container {
            width: 100%;
            height: 280px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .image-container img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-top-color: white;
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .image-info {
            padding: 15px;
        }

        .image-prompt {
            font-size: 14px;
            color: #495057;
            margin-bottom: 12px;
            line-height: 1.5;
        }

        .image-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .image-ratio {
            background: #667eea;
            color: white;
            padding: 5px 12px;
            border-radius: 8px;
            font-size: 12px;
            font-weight: 700;
        }

        .download-btn {
            background: #28a745;
            color: white;
            border: none;
            padding: 6px 15px;
            border-radius: 8px;
            font-weight: 700;
            cursor: pointer;
            font-size: 12px;
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #adb5bd;
        }

        .empty-icon {
            font-size: 70px;
            margin-bottom: 15px;
        }

        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.85);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            backdrop-filter: blur(8px);
        }

        .loading-overlay.active {
            display: flex;
        }

        .loading-content {
            text-align: center;
            color: white;
        }

        .loading-spinner-large {
            width: 70px;
            height: 70px;
            border: 5px solid rgba(255, 255, 255, 0.2);
            border-top-color: #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        .loading-text {
            font-size: 22px;
            font-weight: 700;
            margin-bottom: 10px;
        }

        .loading-progress {
            font-size: 18px;
            color: #667eea;
        }

        .toast {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: white;
            padding: 18px 25px;
            border-radius: 12px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.2);
            display: none;
            gap: 10px;
            z-index: 10000;
            min-width: 300px;
        }

        .toast.show {
            display: flex;
            animation: slideIn 0.4s;
        }

        @keyframes slideIn {
            from { transform: translateX(400px); }
            to { transform: translateX(0); }
        }

        .toast.success { border-left: 5px solid #28a745; }
        .toast.error { border-left: 5px solid #dc3545; }
        .toast.info { border-left: 5px solid #17a2b8; }

        .toast-content {
            flex: 1;
        }

        .toast-title {
            font-weight: 700;
            margin-bottom: 4px;
            font-size: 14px;
        }

        .toast-message {
            font-size: 13px;
            color: #6c757d;
        }

        @media (max-width: 1024px) {
            .body { grid-template-columns: 1fr; }
            .ratio-grid { grid-template-columns: repeat(4, 1fr); }
        }

        @media (max-width: 768px) {
            .main { padding: 20px; }
            .ratio-grid { grid-template-columns: repeat(2, 1fr); }
            .results-grid { grid-template-columns: 1fr; }
            .api-input-group { flex-direction: column; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üé® AI Image Generator Pro</h1>
            <p>Real Hugging Face AI ‚Ä¢ Verified API ‚Ä¢ Prompt-accurate images</p>
        </div>

        <div class="body">
            <div class="sidebar">
                <div class="section-title">üìê ASPECT RATIO</div>
                <div class="ratio-grid">
                    <div class="ratio-card active" data-ratio="1:1">
                        <span class="ratio-icon">‚¨ú</span>
                        <div class="ratio-label">1:1</div>
                        <div class="ratio-desc">Square</div>
                    </div>
                    <div class="ratio-card" data-ratio="16:9">
                        <span class="ratio-icon">üñ•Ô∏è</span>
                        <div class="ratio-label">16:9</div>
                        <div class="ratio-desc">Landscape</div>
                    </div>
                    <div class="ratio-card" data-ratio="9:16">
                        <span class="ratio-icon">üì±</span>
                        <div class="ratio-label">9:16</div>
                        <div class="ratio-desc">Portrait</div>
                    </div>
                    <div class="ratio-card" data-ratio="3:4">
                        <span class="ratio-icon">üñºÔ∏è</span>
                        <div class="ratio-label">3:4</div>
                        <div class="ratio-desc">Portrait</div>
                    </div>
                </div>
            </div>

            <div class="main">
                <!-- API Setup Section -->
                <div class="api-setup">
                    <h3>üîë Setup API Key (One Time - FREE)</h3>
                    <div class="api-steps">
                        <ol>
                            <li>Visit <a href="https://huggingface.co/join" target="_blank">Hugging Face</a> and create FREE account</li>
                            <li>Go to <a href="https://huggingface.co/settings/tokens" target="_blank">Settings ‚Üí Access Tokens</a></li>
                            <li>Click "New token" ‚Üí Select "Read" permission ‚Üí Create</li>
                            <li>Copy token and paste below, then click "Verify API"</li>
                        </ol>
                    </div>

                    <div class="api-input-group">
                        <input 
                            type="text" 
                            class="api-input" 
                            id="apiKeyInput" 
                            placeholder="hf_xxxxxxxxxxxxxxxxxxxxx"
                        />
                        <button class="verify-btn" id="verifyBtn">
                            ‚úì Verify API
                        </button>
                    </div>

                    <div class="api-status" id="apiStatus"></div>

                    <div class="api-warning">
                        ‚ö†Ô∏è <strong>Important:</strong> Without valid API key, images will NOT generate!
                    </div>
                </div>

                <!-- Prompt Section -->
                <div class="prompt-section">
                    <div class="prompt-header">
                        <h2 class="prompt-title">üìù Enter Your Prompts</h2>
                        <div class="prompt-badge">
                            <span id="promptCount">0</span> Prompts
                        </div>
                    </div>

                    <textarea 
                        class="prompt-textarea" 
                        id="promptInput" 
                        placeholder="Enter detailed prompts (one per line):

WORKING EXAMPLES:

A majestic lion with golden mane standing on rocky cliff at golden sunset, dramatic orange sky, professional wildlife photography, highly detailed, 8k resolution

Futuristic cyberpunk city at night with glowing neon purple and blue lights, wet reflective streets, flying cars in sky, cinematic atmosphere, highly detailed

Beautiful pink cherry blossom tree in full bloom, Japanese garden setting, spring season, soft natural sunlight, professional nature photography, vibrant colors

Cozy wooden log cabin in snowy mountain landscape, winter evening, warm yellow lights from windows, smoke from chimney, peaceful atmosphere, photorealistic

Vintage red Ferrari 250 GTO in vast desert landscape at golden hour, dramatic sunset lighting, professional automotive photography, ultra detailed

üí° PERFECT RESULTS TIPS:
‚Ä¢ Use VERY detailed descriptions
‚Ä¢ Add quality keywords: photorealistic, highly detailed, 8k, professional photography
‚Ä¢ Mention lighting: golden hour, cinematic, dramatic, soft natural light
‚Ä¢ Include atmosphere: peaceful, vibrant, dramatic, cozy
‚Ä¢ Be specific about colors, textures, mood"></textarea>

                    <div class="prompt-footer">
                        <span>ü§ñ Real AI ‚Ä¢ API Verified Required</span>
                        <span id="charCount">0 characters</span>
                    </div>

                    <button class="generate-btn" id="generateBtn" disabled>
                        üöÄ Generate AI Images
                    </button>
                </div>

                <!-- Results Section -->
                <div class="results-section">
                    <div class="results-header">
                        <h2 class="results-title">
                            üñºÔ∏è Generated Images (<span id="resultCount">0</span>)
                        </h2>
                        <button class="clear-btn" id="clearBtn" style="display: none;">
                            üóëÔ∏è Clear All
                        </button>
                    </div>

                    <div class="results-grid" id="resultsGrid">
                        <div class="empty-state">
                            <div class="empty-icon">üé®</div>
                            <h3>No images generated yet</h3>
                            <p>Verify API key, enter prompts, and start generating!</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-content">
            <div class="loading-spinner-large"></div>
            <div class="loading-text">Generating real AI images...</div>
            <div class="loading-progress" id="progressText">Please wait 20-30 seconds per image</div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div class="toast" id="toast">
        <div class="toast-content">
            <div class="toast-title" id="toastTitle"></div>
            <div class="toast-message" id="toastMessage"></div>
        </div>
    </div>

    <script>
        // DOM Elements
        const apiKeyInput = document.getElementById('apiKeyInput');
        const verifyBtn = document.getElementById('verifyBtn');
        const apiStatus = document.getElementById('apiStatus');
        const promptInput = document.getElementById('promptInput');
        const promptCount = document.getElementById('promptCount');
        const charCount = document.getElementById('charCount');
        const generateBtn = document.getElementById('generateBtn');
        const resultsGrid = document.getElementById('resultsGrid');
        const resultCount = document.getElementById('resultCount');
        const clearBtn = document.getElementById('clearBtn');
        const loadingOverlay = document.getElementById('loadingOverlay');
        const progressText = document.getElementById('progressText');
        const ratioCards = document.querySelectorAll('.ratio-card');

        // State
        let selectedRatio = '1:1';
        let generatedImages = [];
        let apiKeyVerified = false;
        let verifiedApiKey = '';

        // Load saved API key
        const savedKey = localStorage.getItem('hf_api_key');
        const savedVerified = localStorage.getItem('hf_api_verified');
        if (savedKey && savedVerified === 'true') {
            apiKeyInput.value = savedKey;
            verifiedApiKey = savedKey;
            apiKeyVerified = true;
            apiStatus.className = 'api-status success';
            apiStatus.textContent = '‚úì API Key Verified! Ready to generate images.';
            verifyBtn.textContent = '‚úì Verified';
            verifyBtn.style.background = '#28a745';
        }

        // Update counters
        promptInput.addEventListener('input', function() {
            const lines = this.value.split('\n').filter(l => l.trim());
            promptCount.textContent = lines.length;
            charCount.textContent = this.value.length + ' characters';
            generateBtn.disabled = lines.length === 0 || !apiKeyVerified;
        });

        // Ratio selection
        ratioCards.forEach(card => {
            card.addEventListener('click', function() {
                ratioCards.forEach(c => c.classList.remove('active'));
                this.classList.add('active');
                selectedRatio = this.dataset.ratio;
            });
        });

        // Verify API Key
        verifyBtn.addEventListener('click', async function() {
            const apiKey = apiKeyInput.value.trim();
            
            if (!apiKey) {
                showToast('Error', 'Please enter API key!', 'error');
                return;
            }

            if (!apiKey.startsWith('hf_')) {
                showToast('Invalid Format', 'API key should start with "hf_"', 'error');
                return;
            }

            verifyBtn.disabled = true;
            verifyBtn.textContent = '‚è≥ Verifying...';
            apiStatus.className = 'api-status';
            apiStatus.style.display = 'none';

            try {
                // Test API with a simple model query
                const response = await fetch('https://api-inference.huggingface.co/models/stabilityai/stable-diffusion-2-1', {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${apiKey}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        inputs: 'test',
                        parameters: {}
                    })
                });

                if (response.status === 401 || response.status === 403) {
                    throw new Error('Invalid API key');
                }

                // Success
                verifiedApiKey = apiKey;
                apiKeyVerified = true;
                localStorage.setItem('hf_api_key', apiKey);
                localStorage.setItem('hf_api_verified', 'true');

                apiStatus.className = 'api-status success';
                apiStatus.textContent = '‚úì API Key Verified Successfully! You can now generate images.';
                verifyBtn.textContent = '‚úì Verified';
                verifyBtn.style.background = '#28a745';
                
                showToast('Success!', 'API key verified! Ready to generate images.', 'success');

                // Enable generate button if prompts exist
                const lines = promptInput.value.split('\n').filter(l => l.trim());
                if (lines.length > 0) {
                    generateBtn.disabled = false;
                }

            } catch (error) {
                apiKeyVerified = false;
                verifiedApiKey = '';
                localStorage.removeItem('hf_api_key');
                localStorage.removeItem('hf_api_verified');

                apiStatus.className = 'api-status error';
                apiStatus.textContent = '‚ùå Invalid API Key! Please check and try again.';
                verifyBtn.textContent = '‚úó Try Again';
                verifyBtn.disabled = false;

                showToast('Verification Failed', 'Invalid API key. Please check and try again.', 'error');
            }
        });

        // Generate Images
        generateBtn.addEventListener('click', async function() {
            if (!apiKeyVerified) {
                showToast('Error', 'Please verify API key first!', 'error');
                return;
            }

            const prompts = promptInput.value.split('\n').filter(l => l.trim());
            if (prompts.length === 0) return;

            resultsGrid.innerHTML = '';
            generatedImages = [];
            clearBtn.style.display = 'none';
            loadingOverlay.classList.add('active');
            generateBtn.disabled = true;

            const apiEndpoint = 'https://api-inference.huggingface.co/models/stabilityai/stable-diffusion-2-1';

            for (let i = 0; i < prompts.length; i++) {
                progressText.textContent = `Generating image ${i + 1} / ${prompts.length}... (20-30 sec each)`;

                const card = createImageCard(prompts[i], i);
                resultsGrid.appendChild(card);

                try {
                    const response = await fetch(apiEndpoint, {
                        method: 'POST',
                        headers: {
                            'Authorization': `Bearer ${verifiedApiKey}`,
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            inputs: prompts[i],
                            parameters: {
                                negative_prompt: "blurry, low quality, distorted, ugly, bad anatomy",
                                num_inference_steps: 50,
                                guidance_scale: 7.5
                            }
                        })
                    });

                    if (!response.ok) {
                        if (response.status === 503) {
                            // Model loading, wait and retry
                            await new Promise(resolve => setTimeout(resolve, 20000));
                            
                            const retryResponse = await fetch(apiEndpoint, {
                                method: 'POST',
                                headers: {
                                    'Authorization': `Bearer ${verifiedApiKey}`,
                                    'Content-Type': 'application/json'
                                },
                                body: JSON.stringify({
                                    inputs: prompts[i],
                                    parameters: {
                                        negative_prompt: "blurry, low quality, distorted, ugly",
                                        num_inference_steps: 50
                                    }
                                })
                            });

                            if (!retryResponse.ok) throw new Error('Generation failed');
                            const blob = await retryResponse.blob();
                            displayImage(card, blob, prompts[i], i);
                        } else {
                            throw new Error(`API Error: ${response.status}`);
                        }
                    } else {
                        const blob = await response.blob();
                        displayImage(card, blob, prompts[i], i);
                    }

                } catch (error) {
                    console.error('Error:', error);
                    const imageContainer = card.querySelector('.image-container');
                    imageContainer.innerHTML = `
                        <div style="color: white; padding: 20px; text-align: center;">
                            ‚ùå Generation Failed<br>
                            <small>${error.message}</small>
                        </div>
                    `;
                }

                await new Promise(resolve => setTimeout(resolve, 2000));
            }

            loadingOverlay.classList.remove('active');
            generateBtn.disabled = false;
            clearBtn.style.display = 'block';
            showToast('Complete!', `Successfully generated ${prompts.length} images!`, 'success');
        });

        function displayImage(card, blob, prompt, index) {
            const imageUrl = URL.createObjectURL(blob);
            const imageContainer = card.querySelector('.image-container');
            const img = document.createElement('img');
            img.src = imageUrl;
            img.alt = prompt;
            imageContainer.innerHTML = '';
            imageContainer.appendChild(img);

            generatedImages.push({
                prompt: prompt,
                ratio: selectedRatio,
                blob: blob,
                url: imageUrl
            });

            resultCount.textContent = generatedImages.length;
        }

        function createImageCard(prompt, index) {
            const card = document.createElement('div');
            card.className = 'image-card';
            card.innerHTML = `
                <div class="image-container">
                    <div class="loading-spinner"></div>
                </div>
                <div class="image-info">
                    <div class="image-prompt">${prompt}</div>
                    <div class="image-meta">
                        <span class="image-ratio">${selectedRatio}</span>
                        <button class="download-btn" onclick="downloadImage(${index})">
                            ‚¨áÔ∏è Download
                        </button>
                    </div>
                </div>
            `;
            return card;
        }

        function downloadImage(index) {
            const image = generatedImages[index];
            if (image && image.blob) {
                const link = document.createElement('a');
                link.href = URL.createObjectURL(image.blob);
                link.download = `ai-generated-${index + 1}.png`;
                link.click();
                showToast('Downloaded!', 'Image saved successfully.', 'success');
            }
        }

        clearBtn.addEventListener('click', function() {
            if (confirm('Clear all generated images?')) {
                resultsGrid.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">üé®</div>
                        <h3>No images generated yet</h3>
                        <p>Verify API key, enter prompts, and start generating!</p>
                    </div>
                `;
                generatedImages = [];
                resultCount.textContent = '0';
                clearBtn.style.display = 'none';
            }
        });

        function showToast(title, message, type) {
            const toast = document.getElementById('toast');
            const toastTitle = document.getElementById('toastTitle');
            const toastMessage = document.getElementById('toastMessage');
            
            toastTitle.textContent = title;
            toastMessage.textContent = message;
            toast.className = `toast ${type} show`;
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 4000);
        }
    </script>
</body>
</html>
